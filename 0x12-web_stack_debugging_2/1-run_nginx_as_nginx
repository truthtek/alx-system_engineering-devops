#!/usr/bin/env bash
# This script configures the Nginx server to run as the nginx user and listen on port 8080

# Stop the Nginx service
service nginx stop

# Update the Nginx configuration
sed -i 's/user root;/user nginx;/' /etc/nginx/nginx.conf
sed -i 's/listen 80;/listen 8080;/' /etc/nginx/sites-available/default

# Start the Nginx service
service nginx start

# Verify the Nginx process is running as the nginx user and listening on port 8080
ps auxff | grep ngin\[x\]
nc -z 0 8080 && echo "$?" || echo "$?"
